(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{16:function(e,t,n){e.exports=n(39)},39:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(15),c=n.n(l),o=n(3),u=n.n(o),i=n(4),s=n(1),m=function(e){var t=e.blog,n=e.like,l=e.del,c=e.loggedInUser,o={paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},u=t.title,i=t.author,m=t.url,d=t.likes,b=t.id,f=t.user,p=f.name,g=f.username,E=c.name,v=c.username,h=function(e){d+=1,e.preventDefault(),n(b,{title:u,author:i,url:m,likes:d})},k=Object(a.useState)(!1),y=Object(s.a)(k,2),O=y[0],w=y[1],j={display:O?"none":""},C={display:O?"":"none"},S=function(){w(!O)};return p===E&&g===v?r.a.createElement("div",{style:o},r.a.createElement("div",{style:j},t.title," ",t.author,r.a.createElement("button",{type:"submit",onClick:S},"view")),r.a.createElement("div",{style:C},t.title,r.a.createElement("button",{type:"submit",onClick:S},"hide"),r.a.createElement("br",null),t.url,r.a.createElement("br",null),"likes ",t.likes,r.a.createElement("button",{type:"submit",onClick:h},"like"),r.a.createElement("br",null),t.author,r.a.createElement("br",null),r.a.createElement("button",{type:"submit",onClick:function(e){e.preventDefault(),l({title:u,author:i,url:m,likes:d},b)}},"remove"),r.a.createElement("br",null))):r.a.createElement("div",{style:o},r.a.createElement("div",{style:j},t.title," ",t.author,r.a.createElement("button",{type:"submit",onClick:S},"view")),r.a.createElement("div",{style:C},t.title,r.a.createElement("button",{type:"submit",onClick:S},"hide"),r.a.createElement("br",null),t.url,r.a.createElement("br",null),"likes ",t.likes,r.a.createElement("button",{type:"submit",onClick:h},"like"),r.a.createElement("br",null),t.author,r.a.createElement("br",null)))},d=function(e){var t=e.handleClick,n=e.text;return r.a.createElement("button",{onClick:t,type:"submit"},n)},b=function(e){var t=e.login,n=Object(a.useState)(""),l=Object(s.a)(n,2),c=l[0],o=l[1],u=Object(a.useState)(""),i=Object(s.a)(u,2),m=i[0],d=i[1];return r.a.createElement("div",null,r.a.createElement("h2",null,"Login"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(c,m),o(""),d("")}},r.a.createElement("div",null,"username",r.a.createElement("input",{value:c,onChange:function(e){o(e.target.value)}})),r.a.createElement("div",null,"password",r.a.createElement("input",{type:"password",value:m,onChange:function(e){d(e.target.value)}})),r.a.createElement("button",{type:"submit"},"login")))},f=function(e){var t=e.createBlog,n=Object(a.useState)(""),l=Object(s.a)(n,2),c=l[0],o=l[1],u=Object(a.useState)(""),i=Object(s.a)(u,2),m=i[0],d=i[1],b=Object(a.useState)(""),f=Object(s.a)(b,2),p=f[0],g=f[1];return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:m,url:p,likes:0}),o(""),d(""),g("")}},r.a.createElement("div",null,"Title",r.a.createElement("input",{value:c,onChange:function(e){o(e.target.value)}})),r.a.createElement("div",null,"Author",r.a.createElement("input",{value:m,onChange:function(e){d(e.target.value)}})),r.a.createElement("div",null,"URL",r.a.createElement("input",{value:p,onChange:function(e){g(e.target.value)}})),r.a.createElement("button",{type:"submit"},"post"))},p=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),l=Object(s.a)(n,2),c=l[0],o=l[1],u={display:c?"none":""},i={display:c?"":"none"},m=function(){o(!c)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:m}})),r.a.createElement("div",null,r.a.createElement("div",{style:u},r.a.createElement("button",{type:"submit",onClick:m},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement("button",{type:"submit",onClick:m},"cancel")))})),g=function(e){var t=e.message;return null===t?null:r.a.createElement("div",{className:"error"},t)},E=function(){return r.a.createElement("div",{style:{color:"green",fontStyle:"italic",fontSize:16}},r.a.createElement("br",null),r.a.createElement("em",null,"Testing"))},v=n(5),h=n.n(v),k=null,y={getAll:function(){return h.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(i.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,h.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){var n="".concat("/api/blogs","/").concat(e);return h.a.put(n,t).then((function(e){return e.data}))},setToken:function(e){k="bearer ".concat(e)},del:function(){var e=Object(i.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},a="".concat("/api/blogs","/").concat(t),e.next=4,h.a.delete(a,n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},O={login:function(){var e=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],l=t[1],c=Object(a.useState)(null),o=Object(s.a)(c,2),v=o[0],h=o[1],k=Object(a.useState)("some error happened..."),w=Object(s.a)(k,2),j=w[0],C=w[1];Object(a.useEffect)((function(){y.getAll().then((function(e){return l(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);h(t),y.setToken(t.token)}}),[]);var S=r.a.createRef(),x=function(e){try{S.current.toggleVisibility(),y.create(e).then((function(t){l(n.concat(t)),C("a new blog ".concat(e.title," by  ").concat(e.author," added"))}))}catch(t){console.log("failed"),C("Failed to post")}},B=function(e,t){try{y.update(e,t).then((function(a){l(n.map((function(t){return t.id!==e?t:a}))),C("liked ".concat(t.title," by  ").concat(t.author))}))}catch(a){console.log("failed"),C("Failed to like")}},I=function(e,t){try{window.confirm("Remove blog ".concat(e.title," by ").concat(e.author))&&y.del(t).then((function(){l(n.filter((function(e){return e.id!==t}))),C("deleted ".concat(e.title," by  ").concat(e.author))}))}catch(a){console.log("failed"),C("Failed to delete")}},L=function(){var e=Object(i.a)(u.a.mark((function e(t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.login({username:t,password:n});case 3:a=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),y.setToken(a.token),h(a),C("logged in"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("failed"),C("Wrong username or password");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),T=function(){var e=Object(i.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{window.localStorage.removeItem("loggedBlogappUser"),y.setToken(""),h(null),console.log("logged out")}catch(n){console.log("failed to log out")}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return null===v?r.a.createElement("div",null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement(g,{message:j}),r.a.createElement(p,{buttonLabel:"login"},r.a.createElement(b,{login:L})),r.a.createElement(E,null)):r.a.createElement("div",null,r.a.createElement("h2",null,"blogs"),r.a.createElement(g,{message:j}),r.a.createElement("p",null,v.name," logged in ",r.a.createElement(d,{handleClick:T,text:"logout"})),r.a.createElement(p,{buttonLabel:"create new blog",ref:S},r.a.createElement(f,{createBlog:x})),r.a.createElement(d,{handleClick:function(){y.getAll().then((function(e){return l(e)}))},text:"sort by id asc"}),r.a.createElement(d,{handleClick:function(){l(n.sort((function(e,t){return e.likes-t.likes})).map((function(e){return e})))},text:"sort by likes asc"}),r.a.createElement(d,{handleClick:function(){l(n.sort((function(e,t){return t.likes-e.likes})).map((function(e){return e})))},text:"sort by likes desc"}),n.map((function(e){return r.a.createElement(m,{key:e.id,blog:e,like:B,del:I,loggedInUser:v})})),r.a.createElement("br",null),r.a.createElement(E,null),r.a.createElement("br",null))};c.a.render(r.a.createElement(w,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.200134bd.chunk.js.map